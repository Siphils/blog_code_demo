### [darren's blog](https://darren.work)原创音乐播放器使用方法

*注：本播放器非通用，因为是为自己博客定制的，也没有精力去做成插件形式，所以如果有需要的用户可以考虑做适当修改后直接拿去使用，有能力的玩家可以直接自己改写，虽然代码被我压缩了（抱歉，我自己也找不到源码了）*

播放器文件说明：

-   dplay.js

    播放器主js文件，需要在页面底部引用

-   dplay.css

    播放器主css文件，可以引用在页面任意位置，建议和js放在一起方便查看

-   dplay.php

    根据网易云音乐的id解析网易云音乐音频文件真实地址和歌词lrc的代理php，所以您的空间必须要支持php

-   dplay.json

    你的歌单，格式为二维数组

    [

    ​	[音乐ID,显示名称],

    ​	[音乐ID,显示名称]

    ]

    歌曲ID获取方法，网易云音乐搜索音乐，打开歌曲播放页面，最终浏览器地址栏最后的ID即为歌曲ID

    如：http://music.163.com/#/song?id=29717271 歌曲ID为 **29717271**，歌曲名称可以随意填写

使用方法：

-   你的页面必须引用jQuery
-   下载dplay.js / dplay.css / dplay.php / dplay.json ，修改dplay.js最后一句init方法的参数，修改为您需要显示歌词的容器的jQuery选择器，比如假设我想在一个 **id**为**lrc**的div中显示歌词那么`init('#lrc')`即可
-   将四个文件上传至您的空间任意目录，**请注意它们必须在同一目录**，因为js会根据自身目录去拼接获取json和php的地址。
-   然后在你的页面最底部引入dplay.css和dplay.js，即可自动初始化自动播放，所以建议自己判断浏览器是否支持html5的audio以及是否允许播放跨域音频 后动态引入CSS和js比较合适。
-   播放器会自动在您的页面底部插入一个canvas以显示音频频谱，canvas元素的zIndex在css中设置成了0，但是还是有可能会遮挡您的页面元素，所以建议将您的body下面的其他非定位的一级元素设置成`{position:relative;z-index:1}`，这样可以避免频谱遮挡您的页面元素。



您的博客最好要支持pjax，否则页面跳转可能会有简短的中断播放，为了达到最大的兼容，播放器默认会在不支持pjax的页面跳转后接着上次播放的地方继续播放，会记录播放/暂停的状态。为了不干扰用户，如果您同时打开多个您的页面，后打开的页面会接着播放音乐，之前的页面会自动暂停播放，以便同时只会有一个页面发出声音。

显示频谱比较耗电，所以播放器会判断您的显示设备，如果是笔记本，并且使用的是电池（没有接通外接电源），则会自动关闭频谱以省电，当您接入电源后会立刻显示频谱。

更多问题欢迎在我的博客留言咨询。

